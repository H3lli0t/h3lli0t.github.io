---
title: "PowerShell For Pentesters"
layout: post
date: 2023-10-27 22:44
image: https://skillforge.com/wp-content/uploads/2022/06/powershell.png
headerImage: true
tag:
- Tips
- Powershell
- Ethical Hacking
- Pentesting
- Windows
- Active Directory
star: false
category: blogs
author: johndoe
description: ""

---

# Overview

This blog covers the principle uses of PowerShell in Penetration Tests. Interacting with files, scanning the network and system enumeration...

---

# Basic PowerShell Commands

### Get the current working directory

```bash
Get-Location
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 12_58_37-Window.png>)

### Checking the existence of a path

```bash
Test-Path 'C:\Users\Document\Desktop\fake_flag.txt'
Test-Path 'C:\Users\Document\Desktop\flag.txt'
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_01_43-Window.png>)

### Get the location of a file

```bash
Get-ChildItem -r -Include *flag.txt*
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 12_46_22-Window.png>)

### Get the content of a file

```bash
Get-Content 'C:\Users\Document\Desktop\flag.txt'
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 12_48_00-Window.png>)

### Know the owner of a file

```bash
Get-Acl 'C:\Users\Document\Desktop\flag.txt'
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_40_00-Window.png>)

### Get the MD5 hash of a file

```bash
Get-FileHash -Algorithm MD5 'C:\Users\Document\Desktop\flag.txt'
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 12_50_55-Window.png>)

### Search for files containing PASSWORD

```bash
Get-ChildItem -r | Select-String "PASSWORD"
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_34_50-Window.png>)

### Get Clipboard

```bash
Get-Clipboard
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 14_16_36-Window.png>)

### Base64 decoding a file

```bash
$file = "msg.txt"; [System.Convert]::FromBase64String((Get-Content $file)) | Set-Content output.txt -Encoding Byte
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_08_59-Window.png>)

```bash
certutil -decode msg.txt out.txt
```
![Alt text](<../../assets/images/BlogPics/2023-11-23 13_12_30-Window.png>)

### Secure String to Plaintext

```bash
$pw = "<Password>" | convertto-securestring
$cred = new-object system.management.automation.pscredential("H3lli0t", $pw)
$cred.getnetworkcredential() | fl *
```

<br/>

# Enumeration

### List users on the machine

```bash
Get-LocalUser
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_15_00-Window.png>)

### List groups on the machine

```bash
Get-LocalGroup | measure
Get-LocalGroup
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_44_59-Window.png>)

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_16_31-Window.png>)

### Get IP address info

```bash
Get-NetIPAddress
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_25_42-Window.png>)

### List listening connections

```bash
Get-NetTCPConnection -State Listen
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_27_55-Window.png>)

### List running processes

```bash
Get-Process
Get-Process | where {$_.ProcessName -like "chrome"} | ft ProcessName, Id
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_37_25-Window.png>)

![Alt text](<../../assets/images/BlogPics/2023-11-23 14_02_55-Window.png>)

### Get running services

```bash
Get-Service
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_55_41-Window.png>)

### Get scheduled tasks

```bash
Get-ScheduledTask
Get-ScheduledTask | findstr /i lenovo
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_42_00-Window.png>)

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_47_52-Window.png>)

### List applied patches 

```bash
Get-HotFix
```

![Alt text](<../../assets/images/BlogPics/2023-11-23 13_49_38-Window.png>)

<br/>

# Summary

PowerShell proves to be an indispensable tool for penetration testers, offering a powerful platform to assess and enhance the security of systems. Its scripting capabilities, coupled with a wide range of built-in functions, enable testers to automate tasks and exploit vulnerabilities. That's what makes Powershell a key component in a pentester's toolkit.

<br/>

That was the end of the blog, thanks for reading, I hope you learnt something new.

<p>Happy Hacking!</p>